=== Compile & Run Instructions ===

```
cmsrel CMSSW_15_0_0_pre2
cd CMSSW_15_0_0_pre2/src
cmsenv
git cms-checkout-topic -u P2-Tracker-BES-SW:unpackers_15_0_0_pre2
scram b -j
cd EventFilter/Phase2TrackerRawToDigi/test/
# Run cluster --> RAW --> cluster sequence for Outer Tracker.
cmsRun SLinkProducerAndUnpacker_cfg.py*
```

=== Rebase Instructions ===

If you have a personal branch of this code, and wish to update it with changes made by others to tomalin:masterP2TrackerUnpackers , then in new project area:

```
git cms-checkout-topic -u P2-Tracker-BES-SW:unpackers_15_0_0_pre2
git cms-rebase-topic -u myFork:myBranch
```

=== DTHDAQToFEDRawDataConverter Instructions ===

DTHDAQToFEDRawDataConverter.cc plugin reads `.raw` files generated by the TIF, the .raw files are in DTH DAQ bitstream, the plugin converts the fragments to FEDRawDataCollections.

The plugin code is in [../plugins/DTHDAQToFEDRawDataConverter.cc](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/plugins/DTHDAQToFEDRawDataConverter.cc)


[DTHDAQtoFEDRAWData_cfg.py](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/test/DTHDAQtoFEDRAWData_cfg.py) is the configuration file. 

To run the code: `cmsRun DTHDAQtoFEDRAWData_cfg.py`

To validate the output root file, run `python3 validate.py`

This code makes no assumptions about the number of orbits in the raw file or the fragment sizes (such as the number of events per orbit or whether fragments are uniform in size). It reads the entire file—regardless of how many orbits it contains—and uses the information in each orbit header (orbit size and fragment count) along with each fragment trailer (fragment size) to dynamically process the data.


_**The code throws an error at the end unless you set maxEvent to the actual number of events per file.**_

**However, this could be run without knowing the event number.** Simply go the test directory, and
```
chmod +x runDTHDAQ.sh 
./runDTHDAQ.sh [filename.raw]
```

This counts the number of events in the .raw file and creates a cfg.py configuration file and cmsRuns it.
