DTHDAQToFEDRawDataConverter.cc plugin reads `.raw` files generated by the TIF, the .raw files are in DTH DAQ bitstream, the plugin converts the fragments to FEDRawDataCollections.

The plugin code is in [../plugins/DTHDAQToFEDRawDataConverter.cc](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/plugins/DTHDAQToFEDRawDataConverter.cc)

To create a dummy .raw file that mimics the run the python script in [dummy_raw_generator.py](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/test/dummy_raw_generator.py)
The `dummy_raw_generator.py` and the converter code` DTHDAQToFEDRawDataConverter.cc `are based on [EDMS #2705647](https://edms.cern.ch/ui/file/2705647/3/note_cms_phase2_orbitaggregation.pdf) : "**Orbit Aggregation in the DTH Functional description and data headers**"

The file [_4orbit_data.raw](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/test/_4orbit_data.raw) is generated by that script.

[DTHDAQtoFEDRAWData_cfg.py](https://github.com/P2-Tracker-BES-SW/cmssw/blob/AAA_unpacker/EventFilter/Phase2TrackerRawToDigi/test/DTHDAQtoFEDRAWData_cfg.py) is the configuration file. 

To run the code: `cmsRun DTHDAQtoFEDRAWData_cfg.py`

To validate the output root file, run `python3 validate.py`

Then compare the fragments with the orignal .raw file (I'm in the process of writing a .py script  for that)

This code makes no assumptions about the number of orbits in the raw file or the fragment sizes (such as the number of events per orbit or whether fragments are uniform in size). It reads the entire file—regardless of how many orbits it contains—and uses the information in each orbit header (orbit size and fragment count) along with each fragment trailer (fragment size) to dynamically process the data.


_**The code throws an error at the end unless you set maxEvent to the actual number of events per file.**_

**However, this could be run without knowing the event number.** Simply go the test directory, and
```
chmod +x runDTHDAQ.sh 
./runDTHDAQ.sh [filename.raw]
```

This counts the number of events in the .raw file and creates a cfg.py configuration file and cmsRuns it.
